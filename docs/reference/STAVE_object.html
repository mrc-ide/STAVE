<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The main class that stores the data and is responsible for all data input,
output, and processing functions. Most of the functionality of the STAVE
package is through this class in the form of member functions."><title>STAVE data object (R6 class) — STAVE_object • STAVE</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="STAVE data object (R6 class) — STAVE_object"><meta property="og:description" content="The main class that stores the data and is responsible for all data input,
output, and processing functions. Most of the functionality of the STAVE
package is through this class in the form of member functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">STAVE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mrc-ide/stave">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>STAVE data object (R6 class)</h1>
      
      <div class="d-none name"><code>STAVE_object.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The main class that stores the data and is responsible for all data input,
output, and processing functions. Most of the functionality of the STAVE
package is through this class in the form of member functions.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The raw data are stored as private variables within this object, meaning they
cannot (or should not) be edited directly. Rather, tables can be extracted
using <code>get_counts()</code> and similarly for other tables. The three tables
are:</p><ol><li><p>studies: Information on where the data came from, for example a url
    and author names. Each study is indexed with a unique study_ID.</p></li>
<li><p>surveys: Information on the surveys represented within a study. A
    survey is defined here as a discrete instance of data collection, which
    includes information on geography (latitude and longitude) and collection
    time. Surveys are given survey_IDs and are linked to a particular study
    through the study_ID.</p></li>
<li><p>counts: The actual genetic information, which is linked to a
    particular survey through the survey_ID. Genetic variants are encoded in
    character strings that must follow a specified format, and the number of
    times this variant was observed among the total sample is stored in
    columns.</p></li>
</ol><p>This combination of linked tables allows efficient and flexible encoding of
variants, while avoiding unnecessary duplication of information.</p>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-STAVE_object-print"><code>STAVE_object$print()</code></a></p></li>
<li><p><a href="#method-STAVE_object-get_studies"><code>STAVE_object$get_studies()</code></a></p></li>
<li><p><a href="#method-STAVE_object-get_surveys"><code>STAVE_object$get_surveys()</code></a></p></li>
<li><p><a href="#method-STAVE_object-get_counts"><code>STAVE_object$get_counts()</code></a></p></li>
<li><p><a href="#method-STAVE_object-get_version"><code>STAVE_object$get_version()</code></a></p></li>
<li><p><a href="#method-STAVE_object-append_data"><code>STAVE_object$append_data()</code></a></p></li>
<li><p><a href="#method-STAVE_object-get_prevalence"><code>STAVE_object$get_prevalence()</code></a></p></li>
<li><p><a href="#method-STAVE_object-get_variants"><code>STAVE_object$get_variants()</code></a></p></li>
<li><p><a href="#method-STAVE_object-drop_study"><code>STAVE_object$drop_study()</code></a></p></li>
<li><p><a href="#method-STAVE_object-clone"><code>STAVE_object$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-STAVE_object-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Custom print method to control console output</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-STAVE_object-get_studies"></a><div class="section">
<h3 id="method-get-studies-">Method <code>get_studies()</code><a class="anchor" aria-label="anchor" href="#method-get-studies-"></a></h3>
<p>Extract the studies data.frames stored within the object</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">get_studies</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-STAVE_object-get_surveys"></a><div class="section">
<h3 id="method-get-surveys-">Method <code>get_surveys()</code><a class="anchor" aria-label="anchor" href="#method-get-surveys-"></a></h3>
<p>Extract the surveys data.frames stored within the object</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">get_surveys</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-STAVE_object-get_counts"></a><div class="section">
<h3 id="method-get-counts-">Method <code>get_counts()</code><a class="anchor" aria-label="anchor" href="#method-get-counts-"></a></h3>
<p>Extract the counts data.frames stored within the object</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">get_counts</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-STAVE_object-get_version"></a><div class="section">
<h3 id="method-get-version-">Method <code>get_version()</code><a class="anchor" aria-label="anchor" href="#method-get-version-"></a></h3>
<p>Extract the version number of the STAVE object. This is important as
member functions of a STAVE object are directly linked to the object
itself, and will not be updated by updating the version of the package in
your environment. To update a STAVE object to a new package version, you
should first extract the data and then load into a new STAVE object
created with the most recent version.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">get_version</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-STAVE_object-append_data"></a><div class="section">
<h3 id="method-append-data-">Method <code>append_data()</code><a class="anchor" aria-label="anchor" href="#method-append-data-"></a></h3>
<p>Append new data</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">append_data</span><span class="op">(</span></span>
<span>  <span class="va">studies_dataframe</span>,</span>
<span>  <span class="va">surveys_dataframe</span>,</span>
<span>  <span class="va">counts_dataframe</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>studies_dataframe</code></dt>
<dd><p>a data.frame containing information at the study
level. This data.frame must have the following columns: study_ID,
study_name, study_type, authors, publication_year, url</p></dd>


<dt><code>surveys_dataframe</code></dt>
<dd><p>a data.frame containing information at the
survey level. This data.frame must have the following columns:
study_key, survey_ID, country_name, site_name, lat, lon, spatial_notes,
collection_start, collection_end, time_notes. The study_key element
must correspond to a study_ID in the studies_dataframe.</p></dd>


<dt><code>counts_dataframe</code></dt>
<dd><p>a data.frame of genetic information. Must contain
the following columns: survey_key, variant_string, variant_num,
total_num. The survey_key element must correspond to a valid survey_ID
in the surveys_dataframe.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-STAVE_object-get_prevalence"></a><div class="section">
<h3 id="method-get-prevalence-">Method <code>get_prevalence()</code><a class="anchor" aria-label="anchor" href="#method-get-prevalence-"></a></h3>
<p>Calculate prevalence</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">get_prevalence</span><span class="op">(</span></span>
<span>  <span class="va">target_variant</span>,</span>
<span>  keep_ambiguous <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prev_from_min <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>target_variant</code></dt>
<dd><p>the name of the variant on which we want to
calculate prevalence, for example crt:72:C. Note that there can be no
heterozygous calls within this name.</p></dd>


<dt><code>keep_ambiguous</code></dt>
<dd><p>there may be variants in the data for which the
target_variant could be in the sample, but this cannot be proven
conclusively. For example, the sequence A_A_A may be a match to the
sequence A/C_A/C_A or it may not, these are unphased genotypes so we
cannot be sure. If <code>keep_ambiguous = TRUE</code> then both a min and a
max numerator are reported that either exclude all ambiguous calls
(min) or include all ambiguous calls (max). If <code>FALSE</code> (the
default) then only the min is reported.</p></dd>


<dt><code>prev_from_min</code></dt>
<dd><p>the output object includes a point estimate of the
prevalence along with exact binomial confidence intervals. These must
be calculated from one of <code>numerator_min</code> or <code>numerator_max</code>
in the case of ambiguous calls. This argument sets which one of these
numerators is used in the calculation.</p>
<p>@import dplyr</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-STAVE_object-get_variants"></a><div class="section">
<h3 id="method-get-variants-">Method <code>get_variants()</code><a class="anchor" aria-label="anchor" href="#method-get-variants-"></a></h3>
<p>Return a vector of all variants present in the data object.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">get_variants</span><span class="op">(</span>report_haplo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>report_haplo</code></dt>
<dd><p>(Boolean) if TRUE then list all haplotypes.
Otherwise, list in locus-by-locus format. Defaults to FALSE.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-STAVE_object-drop_study"></a><div class="section">
<h3 id="method-drop-study-">Method <code>drop_study()</code><a class="anchor" aria-label="anchor" href="#method-drop-study-"></a></h3>
<p>Drop one or more study_IDs from the data. This will drop from all
internally stored data objects, including the corresponding surveys and
counts data.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">drop_study</span><span class="op">(</span><span class="va">drop_study_ID</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>drop_study_ID</code></dt>
<dd><p>a vector of study_IDs to drop from all data objects.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-STAVE_object-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">STAVE_object</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

