<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="STAVE">
<title>data_format • STAVE</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="data_format">
<meta property="og:description" content="STAVE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">STAVE</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mrc-ide/stave">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>data_format</h1>
            
      
      
      <div class="d-none name"><code>data_format.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">STAVE</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="avoiding-duplication-of-information">1. Avoiding duplication of information<a class="anchor" aria-label="anchor" href="#avoiding-duplication-of-information"></a>
</h3>
<p>STAVE achieves a relatively efficient encoding through a relational
database structure. There are three tables that make up this
database:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Studies</strong>: This is a record of where the data came
from. This could be academic publications, reports, or other sources of
information.</li>
<li>
<strong>Surveys</strong>: A survey is defined here as a discrete
instance of data collection. Survey-level data include information on
location (latitude and longitude) and time (day) of collection. There
may be multiple surveys within a given study, for example different
sampling sites or different collection periods may come from the same
academic publication.</li>
<li>
<strong>Counts</strong>: This is where the aggregate genetic data
are stored. Data include the name of the variant that was observed
(i.e. the gene, locus, and mutation), how many times it was observed,
and how many times it was successfully tested for.</li>
</ol>
<p>Separating the data into tables helps eliminate duplication and
improve efficiency. For instance, if the data originate from an academic
paper, the same list of authors will typically apply to all surveys
reported within that paper. Repeating this information for each survey
is not only inefficient but also increases the risk of data entry
errors. To address this, we store shared information, such as
authorship, at the study level and link it to survey-level data using a
relational key. This approach ensures that the information is stored
only once while maintaining clear connections between studies and their
associated surveys.</p>
</div>
<div class="section level3">
<h3 id="nailing-down-the-input-format">2. Nailing down the input format<a class="anchor" aria-label="anchor" href="#nailing-down-the-input-format"></a>
</h3>
<p>STAVE performs close to 100 different checks on the data when it is
read in. This includes everything from character formatting to checking
that prevalence cannot exceed 100%. Having this extremely pedantic
series of checks ensures that we know exactly what we have once loaded,
which makes life easier when it comes to downstream analysis.</p>
</div>
<div class="section level3">
<h3 id="flexible-encoding-genetic-variants">3. Flexible encoding genetic variants<a class="anchor" aria-label="anchor" href="#flexible-encoding-genetic-variants"></a>
</h3>
<p>Encoding <em>Plasmodium</em> genetic data can be challenging due to
the complexity and variability of the information involved. Sequence
data may be recorded at the single-codon level or across multiple
codons, and heterozygous calls — where more than one allele is observed
— can occur at some codons but not others. These heterozygous calls may
also be phased or unphased, adding another layer of detail. Furthermore,
patterns of missingness can vary between individuals, causing the
denominator to vary as we look along the genome. In many cases,
particularly when working with aggregate counts extracted from published
studies, some of this detailed information may be incomplete or entirely
unavailable. Therefore, we require an encoding system that is both
flexible and expressive: capable of capturing this complexity when the
data are available, but not overly restrictive in situations where
certain aspects are missing.</p>
<p>A drawback of this flexible encoding is that calculating prevalence
becomes less straightforward. This trade-off is somewhat unavoidable, as
flexibility in data encoding and simplicity in prevalence calculation
are somewhat opposing goals. In STAVE, we prioritize achieving a clean
and flexible data structure, ensuring that all relevant information is
captured. Prevalence calculations are then performed using dedicated
member functions that operate on the encoded data.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
